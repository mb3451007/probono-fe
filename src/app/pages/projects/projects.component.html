<div class="row">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header">
        <div class="row">
          <div class="d-none d-sm-block  d-md-block  d-lg-block d-xl-block col-12 my-0 col-sm-12 col-md-12 col-xs-12">
            <h4 class="card-title my-1"> Projects</h4>
            <p class="sum_text text-muted m-0">Please note: SN = Project Serial Number.</p>
          </div>

          <div class="col-12 col-sm-12 col-md-12 col-xs-12">
            <div class="d-block d-md-flex flex-row">
              <form class="rounded-5 w-100 search_inner_wrap mt-3 mb-0 mx-1 flex-1">
                <div class="input-group border-1 bg-white rounded-5" style="border-radius: 5px; overflow: hidden">
                  <input type="text" value="" [(ngModel)]="filter" class="form-control rounded-5 bg-white" placeholder="Volunteer names...">
                  <div class="input-group-append bg-white rounded-5">
                    <div class="input-group-text bg-white">
                      <i class="nc-icon nc-zoom-split"></i>
                    </div>
                  </div>
                </div>
              </form>

            <form class="rounded-5 w-100 search_inner_wrap mt-3 mb-0 mx-1 flex-1">
              <div class="input-group border-1 bg-white rounded-5" style="border-radius: 5px; overflow: hidden">
                <input type="text" value="" (keyup)="searchFor($event)" class="form-control rounded-5 bg-white" placeholder="Project description...">
                <div class="input-group-append bg-white rounded-5">
                  <div class="input-group-text bg-white">
                    <i class="nc-icon nc-zoom-split"></i>
                  </div>
                </div>
              </div>
            </form>

            <div class="d-flex flex-row">
            <ul class="rounded-5 flex-1 navbar-nav special-button-per-page w-100 mt-3 mb-0 mx-1">
              <li class="nav-item btn-rotate" ngbDropdown placement="bottom-left">
                <a class="nav-link" ngbDropdownToggle id="navbarDropdownMenuLink" >
                  Show: {{itemsPerPage}}
                </a>
                <div ngbDropdownMenu aria-labelledby="navbarDropdownMenuLink" class="dropdown-menu dropdown-menu-left">
                  <a ngbDropdownItem href="javascript:void(0)" (click)="setPerPage(10)">10</a>
                  <a ngbDropdownItem href="javascript:void(0)" (click)="setPerPage(50)">50</a>
                  <a ngbDropdownItem href="javascript:void(0)" (click)="setPerPage(100)">100</a>
                  <a ngbDropdownItem href="javascript:void(0)" (click)="setPerPage(250)">250</a>
                </div>
              </li>
            </ul>

            <ul class="rounded-5 flex-1 navbar-nav special-button-per-page w-100 mt-3 mb-0 mx-1">
              <li class="nav-item btn-rotate" ngbDropdown placement="bottom-left">
                <a class="nav-link" ngbDropdownToggle id="navbarDropdownMenuLink">
                  {{projectsStatus ? projectsStatus : 'All'}}
                </a>
                <div ngbDropdownMenu aria-labelledby="navbarDropdownMenuLink" class="dropdown-menu dropdown-menu-left">
                  <a ngbDropdownItem href="javascript:void(0)" (click)="setProjectsStatus('Not Started')">Not Started</a>
                  <a ngbDropdownItem href="javascript:void(0)" (click)="setProjectsStatus('In Progress')">In Progress</a>
                  <a ngbDropdownItem href="javascript:void(0)" (click)="setProjectsStatus('Completed')">Completed</a>
                  <a ngbDropdownItem href="javascript:void(0)" (click)="setProjectsStatus('')">Show All</a>
                </div>
              </li>
            </ul>
            </div>

            </div>
          </div>
        </div>

      </div>
      <div class="card-body position-relative">
        <div class="w-100 py-5 loading_wrapp align-items-center mx-auto my-5" *ngIf="entriesProjects?.length == 0">
          <div class="text-center">
            <div *ngIf="isLoading === true" class="spinner-grow text-success" style="width: 6rem; height: 6rem;" role="status">
              <span class="sr-only">Loading...</span>
            </div>
            <p *ngIf="isLoading === true" class="text-muted fs-3 fw-normal my-5">Loading records, please wait...</p>
            <p *ngIf="isLoading === false" class="text-muted fs-3 fw-normal my-5">No Records.</p>
          </div>
        </div>
        <div class="loading_wrapper_search" *ngIf="isSearching">
          <div class="text-center">
            <div class="spinner-grow text-success" style="width: 6rem; height: 6rem;" role="status">
              <span class="sr-only">Loading...</span>
            </div>
            <p class="text-muted fs-3 fw-normal my-5">Filtering records, please wait...</p>
          </div>
        </div>
        <div class="table-responsive" *ngIf="entriesProjects.length > 0">
          <table class="table">
            <thead class=" text-primary">
              <th>#</th>
              <th class="text-nowrap" (click)="sortData('name')">Organisation
                <button class="btn sort_button bg-{{sortType === 'name' ? 'success' : 'default'}}">
                  <i class="nc-icon nc-minimal-down" *ngIf="(sortType === 'name' && sortMode === 'asc') ||  sortType === '' || sortType === 'words'"></i>
                  <i class="nc-icon nc-minimal-up" *ngIf="sortType === 'name' && sortMode === 'desc'"></i>
                </button>
              </th>
              <th>SN.</th>
              <th>Description</th>
              <th>Volunteer(s)</th>
              <th>Progress</th>
              <th>Due</th>
            </thead>
            <tbody>
              <tr *ngFor="let rec of entriesProjects | stringFilter: filter | paginate: { itemsPerPage: itemsPerPage, currentPage: page, totalItems: totalItems}; let i = index">
                <td>{{(page - 1) * itemsPerPage + i + 1}})</td>
                <td>{{rec.organisation}}</td>
                <td class="">{{rec.id}}</td>
                <td class="">{{rec.task}}</td>
                <td>
                  <div class="overdue_flag" *ngIf="(rec.due | overdue) && rec.progress !== 'Completed'"><span class="note_due">Overdue</span> <span class="actual_days_missed">{{rec.due | overdue: 'YYYY-MM-DDTHH:mm:ss' }}</span></div>
                  {{rec.volunteerData?.length === 0 ? 'No Volunteer(s).' : ''}}
                  <span *ngFor="let vol of rec.volunteerData; let i = index">{{vol.first_name}} {{vol.last_name}}<ng-container *ngIf="i < rec.volunteerData.length - 1">, </ng-container> </span>
                </td>
                <td class="progress_column">
                  <p [ngClass]="rec.progress === 'Not Started' ? 'bg-info text-white' : rec.progress === 'Completed' ? 'bg-success text-white overide-white-text' : 'bg-warning'"><span [ngStyle]="{'color': rec.progress == 'Completed' ? 'white' : 'black' }">{{rec.progress}}</span></p>
                </td>
                <td>{{rec.due | date: 'mediumDate'}}</td>
              </tr>
            </tbody>
          </table>
          <pagination-controls class="pagi" (pageChange)="loadPage($event)"></pagination-controls>
        </div>
      </div>
    </div>
  </div>
</div>
